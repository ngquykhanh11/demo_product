{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{MainNav}from\"../components/nav\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export const MyProduct=()=>{const[products,setProducts]=useState([]);const[editingId,setEditingId]=useState(null);const[editField,setEditField]=useState(\"\");const[editValue,setEditValue]=useState(\"\");useEffect(()=>{const fetchMyProducts=async()=>{try{const walletAddress=await window.ethereum.request({method:'eth_requestAccounts'});const res=await axios.get(\"http://localhost:8000/api/products\");const myProducts=res.data.content.filter(p=>p.creator===walletAddress[0]);setProducts(myProducts);}catch(err){console.error(\"Failed to fetch products\",err);}};fetchMyProducts();},[]);const handleEdit=async id=>{try{const res=await axios.patch(\"http://localhost:8000/api/product/\".concat(id),null,{params:{column:editField,new_value:editValue}});alert(res.data.message);window.location.reload();// reload after edit\n}catch(err){var _err$response,_err$response$data;alert(\"Update failed: \"+(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||\"Unknown error\"));}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(MainNav,{}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"40px\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"My Products\"}),products.map(product=>/*#__PURE__*/_jsxs(\"div\",{style:{border:\"1px solid #ccc\",padding:\"15px\",margin:\"10px\"},children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Description: \",product.description]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: \",product.price]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Category: \",product.category]}),editingId===product.id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setEditField(e.target.value),value:editField,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select field\"}),/*#__PURE__*/_jsx(\"option\",{value:\"name\",children:\"Name\"}),/*#__PURE__*/_jsx(\"option\",{value:\"description\",children:\"Description\"}),/*#__PURE__*/_jsx(\"option\",{value:\"price\",children:\"Price\"}),/*#__PURE__*/_jsx(\"option\",{value:\"category\",children:\"Category\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"New value\",onChange:e=>setEditValue(e.target.value),value:editValue}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(product.id),children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingId(null),children:\"Cancel\"})]}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingId(product.id),children:\"Edit\"})]},product.id))]})]});};","map":{"version":3,"names":["React","useEffect","useState","axios","MainNav","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MyProduct","products","setProducts","editingId","setEditingId","editField","setEditField","editValue","setEditValue","fetchMyProducts","walletAddress","window","ethereum","request","method","res","get","myProducts","data","content","filter","p","creator","err","console","error","handleEdit","id","patch","concat","params","column","new_value","alert","message","location","reload","_err$response","_err$response$data","response","detail","children","style","padding","map","product","border","margin","name","description","price","category","onChange","e","target","value","type","placeholder","onClick"],"sources":["C:/Users/ADMIN/Downloads/demo/demo/frontend/src/pages/my_product.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { MainNav } from \"../components/nav\";\r\n\r\nexport const MyProduct = () => {\r\n  const [products, setProducts] = useState([]);\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [editField, setEditField] = useState(\"\");\r\n  const [editValue, setEditValue] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const fetchMyProducts = async () => {\r\n      try {\r\n        const walletAddress = await window.ethereum.request({ method: 'eth_requestAccounts' });\r\n        const res = await axios.get(`http://localhost:8000/api/products`);\r\n        const myProducts = res.data.content.filter(p => p.creator === walletAddress[0]);\r\n        setProducts(myProducts);\r\n      } catch (err) {\r\n        console.error(\"Failed to fetch products\", err);\r\n      }\r\n    };\r\n    fetchMyProducts();\r\n  }, []);\r\n\r\n  \r\n\r\n  const handleEdit = async (id) => {\r\n    try {\r\n      const res = await axios.patch(`http://localhost:8000/api/product/${id}`, null, {\r\n        params: { column: editField, new_value: editValue },\r\n      });\r\n      alert(res.data.message);\r\n      window.location.reload(); // reload after edit\r\n    } catch (err) {\r\n      alert(\"Update failed: \" + (err.response?.data?.detail || \"Unknown error\"));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <MainNav />\r\n      <div style={{ padding: \"40px\" }}>\r\n        <h1>My Products</h1>\r\n        {products.map((product) => (\r\n          <div key={product.id} style={{ border: \"1px solid #ccc\", padding: \"15px\", margin: \"10px\" }}>\r\n            <h3>{product.name}</h3>\r\n            <p>Description: {product.description}</p>\r\n            <p>Price: {product.price}</p>\r\n            <p>Category: {product.category}</p>\r\n\r\n            {editingId === product.id ? (\r\n              <>\r\n                <select onChange={(e) => setEditField(e.target.value)} value={editField}>\r\n                  <option value=\"\">Select field</option>\r\n                  <option value=\"name\">Name</option>\r\n                  <option value=\"description\">Description</option>\r\n                  <option value=\"price\">Price</option>\r\n                  <option value=\"category\">Category</option>\r\n                </select>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"New value\"\r\n                  onChange={(e) => setEditValue(e.target.value)}\r\n                  value={editValue}\r\n                />\r\n                <button onClick={() => handleEdit(product.id)}>Save</button>\r\n                <button onClick={() => setEditingId(null)}>Cancel</button>\r\n              </>\r\n            ) : (\r\n              <button onClick={() => setEditingId(product.id)}>Edit</button>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}